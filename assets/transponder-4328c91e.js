import{G as D,T as f,$ as t,M as S,c as r,b as y}from"./DarkTheme-2fd54461.js";import{F as n,a as h,m as O}from"./main-ef562b84.js";const T={available:!1};T.initialize=function(F){let u={},l={NONE:0,TEXT:1,LIST:2},_={0:{dataType:l.NONE},1:{dataType:l.TEXT},2:{dataType:l.LIST,dataOptions:{"ID 1":"E00370FC0FFE07E0FF","ID 2":"007C003EF800FC0FFE","ID 3":"F8811FF8811FFFC7FF","ID 4":"007C003EF81F800FFE","ID 5":"F00FFF00FFF00FF0FF","ID 6":"007CF0C1071F7C00F0","ID 7":"E003F03F00FF03F0C1","ID 8":"00FC0FFE071F3E00FE","ID 9":"E083BFF00F9E38C0FF"}},3:{dataType:l.LIST,dataOptions:{0:"00",1:"01",2:"02",3:"03",4:"04",5:"05",6:"06",7:"07",8:"08",9:"09",10:"0A",11:"0B",12:"0C",13:"0D",14:"0E",15:"0F",16:"10",17:"11",18:"12",19:"13",20:"14",21:"15",22:"16",23:"17",24:"18",25:"19",26:"1A",27:"1B",28:"1C",29:"1D",30:"1E",31:"1F",32:"20",33:"21",34:"22",35:"23",36:"24",37:"25",38:"26",39:"27",40:"28",41:"29",42:"2A",43:"2B",44:"2C",45:"2D",46:"2E",47:"2F",48:"30",49:"31",50:"32",51:"33",52:"34",53:"35",54:"36",55:"37",56:"38",57:"39",58:"3A",59:"3B",60:"3C",61:"3D",62:"3E",63:"3F"}}};if(D.active_tab="transponder",n.CONFIG&&(f.transponder.available=!0),!f.transponder.available){N();return}function N(){t("#content").load("./tabs/transponder.html",I)}function v(e){const a=[];for(let o=0;o<e.length;o+=2)a.push(~parseInt(e.substr(o,2),16));return a}function C(e,a){return e=`${e}`,e.length>=a?e:new Array(a-e.length+1).join("0")+e}function c(e){const a=[];for(let o=0;o<e.length;o++)a.push(C((~e[o]&255).toString(16),2));return a.join("").toUpperCase()}function A(e,a,o){let s=t("#transponder_type_select");s.attr("data-defaultValue",a),s.off("change").change(o),s.html(""),e.length>1&&s.append(t("<option>").attr("value",0).html(r.getMessage("transponderType0")));for(let d in e){let i=e[d];i.hasOwnProperty("id")&&s.append(t("<option>").attr("value",i.id).html(r.getMessage(`transponderType${i.id}`)))}s.val(a)}function E(e,a,o){if(t("#transponderConfiguration").html(""),t("#transponderConfiguration").hide(),t("#transponderHelpBox").hide(),!e)return;let s=t("#transponder-configuration-template").clone();s.find(".spacer_box_title").html(r.getMessage(`transponderData${e.id}`)),s.find(".dataHelp").html(r.getMessage(`transponderDataHelp${e.id}`)),r.getMessage(`transponderHelp${e.id}`).length&&(t("#transponderHelp").html(r.getMessage(`transponderHelp${e.id}`)),t("#transponderHelpBox").show());let d=_[e.id],i=null;switch(d.dataType){case l.TEXT:i=t("<input>").attr("type","text").attr("maxlength",parseInt(e.dataLength)*2),o?i.val(u[e.id]||""):i.val(a);break;case l.LIST:i=t("<select>");for(let p in d.dataOptions){let g=d.dataOptions[p];i.append(t("<option>").val(g).html(p))}i.find(`option[value='${a}']`).length>0&&!o?i.val(a):i.val(u[e.id]||"");break;default:return}o||(u[e.id]=a);let R=function(){let p=t(this).val(),g=new RegExp(`[0-9a-fA-F]{${e.dataLength*2}}`,"gi");p.match(g)?n.TRANSPONDER.data=v(p):n.TRANSPONDER.data=[],u[e.id]=p};i.change(R).keyup(R),s.find(".input_block").html(i),t("#transponder-configuration").html(s.show())}function m(){n.TRANSPONDER.provider=t(this).val(),t(this).attr("data-defaultValue")==t(this).val()?(t(".save_reboot").hide(),t(".save_no_reboot").show()):(t(".save_no_reboot").hide(),t(".save_reboot").show());let a=!0;E(n.TRANSPONDER.providers.find(function(o){return o.id==n.TRANSPONDER.provider}),c(n.TRANSPONDER.data),a)}S.send_message(h.MSP_TRANSPONDER_CONFIG,!1,!1,N);function I(){t(".tab-transponder").toggleClass("transponder-supported",f.transponder.available&&n.TRANSPONDER.supported),r.localizePage(),f.transponder.available&&n.TRANSPONDER.providers.length>0&&(A(n.TRANSPONDER.providers,n.TRANSPONDER.provider,m),E(n.TRANSPONDER.providers.find(function(e){return e.id==n.TRANSPONDER.provider}),c(n.TRANSPONDER.data)),t("a.save").click(function(){let e=this;function a(){S.send_message(h.MSP_SET_TRANSPONDER_CONFIG,O.crunch(h.MSP_SET_TRANSPONDER_CONFIG),!1,o)}function o(){O.writeConfiguration(t(e).hasClass("reboot"))}n.TRANSPONDER.provider!=="0"&&n.TRANSPONDER.data.length!==n.TRANSPONDER.providers.find(function(s){return s.id==n.TRANSPONDER.provider}).dataLength?y(r.getMessage("transponderDataInvalid")):a()})),D.content_ready(F)}};T.cleanup=function(F){F&&F()};f.transponder=T;export{T as transponder};
